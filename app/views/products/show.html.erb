<div class="container">

<div class="col-xs-12">
    <div class="col-sm-6">
        <h1>商品名<br>
        <small><%= @products.title %></small>
        </h1>
    </div>


    <div class="col-sm-6">
        <h3>カテゴリー</h3>
        <% @categories.each do |category| %>
        <%= link_to "#{category.category_name}", class: "btn btn-primary"  %>
        <% end %>
    </div>
</div>
<div class="col-xs-12">
  <hr>
</div>


<div class="row product_show">
    	<div class="col-md-8 text-center">
    		<%= attachment_image_tag @products, :image ,class: "product_show_image" %>
    	</div>

    	<div class="col-md-4">

        <ul class="nav nav-pills">
          <li class="active"><a href="#sampleContentA" data-toggle="tab">商品詳細</a></li>
          <li><a href="#sampleContentB" data-toggle="tab">商品説明</a></li>
          <% if user_signed_in? %>
          <li><a href="#sampleContentC" data-toggle="tab">コメント</a></li>
          <% end %>
        </ul>

<!-- 内容 -->
<div class="tab-content ">
<!--   Aタブ部分    -->
  <div class="tab-pane  active col-md-12 box_scrollbar" id="sampleContentA">
         <h5 class="my-3">商品販売者</h5>
        <ul>
          <%# binding.pry %>
          <li><%= @products.user.id %></li>
        </ul>

        <h5 class="my-3">商品詳細</h5>
        <ul>
          <li>販売者：<%= @products.user.nickname %></li>
          <li>値段：<%= @products.price %></li>
          <li>登録日<%= @products.updated_at.strftime("%Y-%m-%d %H:%M:%S") %></li>
        </ul>

      <h5 class="my-3">商品タグ</h5>
        <ul>
          <% @tags.each do |tag| %>
          <li><%= tag.tag_name %></li>
          <% end %>
        </ul>
    </div>


<!--   Aタブ部分    -->


<!--   Bタブ部分    -->
  <div class="tab-pane col-md-12 box_scrollbar" id="sampleContentB">
       <h5 class="my-3">商品説明</h5>
        <ul>
          <li><%= @products.product_detail %></li>
        </ul>
  </div>
<!--   Bタブ部分    -->

<!--   Cタブ部分    -->
  <div class="tab-pane col-md-12 box_scrollbar" id="sampleContentC">
         <!--コメント機能-->
          <hr>
        <% @product_comments.each do |product_comment| %>
         <div>
          名前：<%= product_comment.user.nickname %>
          コメント：<%= product_comment.comment %>
          <%= product_comment.created_at.strftime('%Y/%m/%d') %>
        </div>
        <% end %>
        <!--ページング機能-->
        <div class="text-center">
          <%= paginate @product_comments, class: "pagenate" %>
        </div>
    <div class="col-md-12">
        <div class="section-title-wrapper style-1 v1 mt-30" id="divAddComment">
        </div>
      <%= form_for [@products, @product_comment] do |f| %>
          <!--エラーメッセージ表示機能-->
          <% if flash[:error].present? %>
            <ul class="errors">
            <% flash[:error].each do |e| %>
              <li>
                <%= e %>
              </li>
            <% end %>
            </ul>
          <% end %>


        <div class="submit">
            <!--コメント送信部分-->
            <%= f.text_field :comment, class: "form-control",placeholder: "コメントをここに" %>
            <%= f.submit "送信する", class: "btn btn-primary pull-right" %>
                    <h5 class="comment-count">
            <%= @products.product_comments.count %>件コメント
          </h5>
        </div>
      <% end %>
    </div>
<!--コメント機能-->
  </div>
<!--   Cタブ部分    -->
         <% if @products.user == current_user || admin_signed_in? %>
          <%= link_to "商品編集", edit_product_path(@products.id), class: "btn btn-success" %>
        <% end %>

        <% if @products.user == current_user || admin_signed_in? %>
          <%= link_to "商品削除", product_path(@products), method: :delete, class: "btn btn-danger", data: { confirm: '本当に消しますか?'} %>
        <% end %>

         <% if @products.user != current_user && user_signed_in? %>
        <%= link_to "お気に入り", add_product_path(@products.id), method: :post , class: "btn btn-success" %>
        <% end %>

        <% if @products.user != current_user && user_signed_in?  %>
          <%= link_to "カートに入れる", product_product_carts_path(@products.id) ,method: :post, class: "btn btn-primary" %>
        <% end %>




</div>
<!-- いいね機能 -->
<% if user_signed_in?  %>
<h5>いいね件数: <%= @products.product_goods.count %></h5>
<% if current_user.already_liked?(@products) %>
  <%= button_to 'いいねを取り消す', product_product_good_path(@products), method: :delete %>
<% else %>
<%= form_for [@products, @product_good] do |f| %>
 <% if @product_good.errors.any? %>
    <% @product_good.errors.full_messages.each do |msg| %>
      <li style="color: red;"><%= msg %></li>
    <% end %>
  <% end %>
  <%= f.submit 'いいね！' %>
<% end %>
<% end %>

<!-- <h2>この記事にいいねしたユーザー</h2> -->
<%# @products.product_good_users.each do |user| %>
  <!-- <li><%#= user.email %></li> -->
<%# end %>
<% end %>
</div>
</div>

